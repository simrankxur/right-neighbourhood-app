import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { forkJoin, map, Observable, of } from 'rxjs';
import { PostcodeData } from './dashboard/postcode-data';

@Injectable({
  providedIn: 'root'
})
export class PostcodeDataService {
  constructor(
    private http: HttpClient
  ) { }

  private readonly apiKey = 'I5T3BNTWP6';
  private testPostcode = 'B4 7ET';

  loadLongAndLat(postcode: string): Observable<any> {
    const url = `https://api.postcodes.io/postcodes/${postcode}`;
    return this.http.get<string>(url);
  }

  loadData(postcode: string, long: string, lat: string): Observable<PostcodeData> {
    if (postcode.toUpperCase() == this.testPostcode) {
      const storedData = {} as PostcodeData;
      storedData.crime = this.testPostcodeStoredCrimeData();
      storedData.restaurants = this.testPostcodeStoredRestaurantData();
      storedData.rents = this.testPostcodeStoredRentsData();
      storedData.prices = this.testPostcodeStoredPricesData();
      return of(storedData);
    }

    // make API calls
    const crime = this.getCrimeData(lat, long);
    const restaurants = this.getRestaurantData(postcode);
    const rents = this.getRentsData(postcode);
    const prices = this.getPricesData(postcode);

    return forkJoin([crime, restaurants, rents, prices]).pipe(map(results => {
      return {
        crime: results[0],
        restaurants: results[1].data.nearby as string,
        rents: results[2].data as string,
        prices: results[3].data as string
      } as PostcodeData;
    }));
  }

  private getCrimeData(lat: string, long: string): Observable<any> {
    const url = `https://data.police.uk/api/crimes-street/all-crime?lat=${lat}&lng=${long}`;
    return this.http.get<string>(url);
  }

  private getRestaurantData(postcode: string): Observable<any> {
    const url = `https://api.propertydata.co.uk/restaurants?key=${this.apiKey}&postcode=${postcode}`;
    return this.http.get<string>(url);
  }

  private getRentsData(postcode: string): Observable<any> {
    const url = `https://api.propertydata.co.uk/rents?key=${this.apiKey}&postcode=${postcode}`;
    return this.http.get<string>(url);
  }

  private getPricesData(postcode: string): Observable<any> {
    const url = `https://api.propertydata.co.uk/prices?key=${this.apiKey}&postcode=${postcode}`;
    return this.http.get<string>(url);
  }

  private testPostcodeStoredCrimeData(): string {
    return '[{"category":"bicycle-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137001,"location_subtype":"STATION","month":"2022-01"},{"category":"bicycle-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137002,"location_subtype":"STATION","month":"2022-01"},{"category":"criminal-damage-arson","location_type":"BTP","location":{"latitude":"52.479000","street":{"id":1488830,"name":"Birmingham Moor Street (station)"},"longitude":"-1.892290"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136519,"location_subtype":"STATION","month":"2022-01"},{"category":"criminal-damage-arson","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136976,"location_subtype":"STATION","month":"2022-01"},{"category":"drugs","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136991,"location_subtype":"STATION","month":"2022-01"},{"category":"drugs","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136990,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136985,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136986,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136987,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136988,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136989,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136984,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136983,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136982,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136981,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136980,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136979,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136978,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.479000","street":{"id":1488830,"name":"Birmingham Moor Street (station)"},"longitude":"-1.892290"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136520,"location_subtype":"STATION","month":"2022-01"},{"category":"other-theft","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136977,"location_subtype":"STATION","month":"2022-01"},{"category":"possession-of-weapons","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137008,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136994,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136995,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136996,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136998,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.479000","street":{"id":1488830,"name":"Birmingham Moor Street (station)"},"longitude":"-1.892290"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136521,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136997,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136992,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136993,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"",'
    + '"outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137000,"location_subtype":"STATION","month":"2022-01"},{"category":"public-order","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136999,"location_subtype":"STATION","month":"2022-01"},{"category":"robbery","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136969,"location_subtype":"STATION","month":"2022-01"},{"category":"shoplifting","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136974,"location_subtype":"STATION","month":"2022-01"},{"category":"shoplifting","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136970,"location_subtype":"STATION","month":"2022-01"},{"category":"shoplifting","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136971,"location_subtype":"STATION","month":"2022-01"},{"category":"shoplifting","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136972,"location_subtype":"STATION","month":"2022-01"},{"category":"shoplifting","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136973,"location_subtype":"STATION","month":"2022-01"},{"category":"shoplifting","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136975,"location_subtype":"STATION","month":"2022-01"},{"category":"theft-from-the-person","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137006,"location_subtype":"STATION","month":"2022-01"},{"category":"theft-from-the-person","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137005,"location_subtype":"STATION","month":"2022-01"},{"category":"theft-from-the-person","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137004,"location_subtype":"STATION","month":"2022-01"},{"category":"theft-from-the-person","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137003,"location_subtype":"STATION","month":"2022-01"},{"category":"theft-from-the-person","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99137007,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136954,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136961,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"Force","location":{"latitude":"52.492237","street":{"id":1258645,"name":"On or near Newtown Middleway"},"longitude":"-1.890658"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"ae6be908175c600518400b31d73b7bb285fce4641eb4a685c7de044522cc60f9","id":98592940,"location_subtype":"","month":"2022-01"},{"category":"violent-crime","location_type":"Force","location":{"latitude":"52.492237","street":{"id":1258645,"name":"On or near Newtown Middleway"},"longitude":"-1.890658"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"8057e8fd8b95e0dce6fe3ed135a3a63c35782c073dfc39458620e50af7a175ca","id":98592941,"location_subtype":"","month":"2022-01"},{"category":"violent-crime","location_type":"Force","location":{"latitude":"52.492237","street":{"id":1258645,"name":"On or near Newtown Middleway"},"longitude":"-1.890658"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"d3ca9a1ac41d28efce20929177350b51fd7fb767900e028abbfa20b72c3c1399","id":98592942,"location_subtype":"","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136959,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"Force","location":{"latitude":"52.475648","street":{"id":1255886,"name":"On or near Nightclub"},"longitude":"-1.887490"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"1eaf016e52236fd6a83a2d8f7881c9d8d57dc664279f3998411e932f100ccce3","id":98370917,"location_subtype":"","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136953,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136964,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136965,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136955,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136956,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136957,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136958,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136962,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,'
    + '"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136960,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136963,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136966,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136967,"location_subtype":"STATION","month":"2022-01"},{"category":"violent-crime","location_type":"BTP","location":{"latitude":"52.478371","street":{"id":1490678,"name":"Birmingham New Street (station)"},"longitude":"-1.898012"},"context":"","outcome_status":{"category":"Under investigation","date":"2022-01"},"persistent_id":"","id":99136968,"location_subtype":"STATION","month":"2022-01"}]';
  }

  private testPostcodeStoredPricesData(): string {
    return '{"points_analysed":20,"radius":"0.18","average":302151,"70pc_range":[232000,467000],"80pc_range":[230000,468000],"90pc_range":[230000,468000],"100pc_range":[85000,469000],"raw_data":[{"price":84950,"lat":"52.48444809","lng":"-1.89005420","bedrooms":2,"type":"detached_house","distance":"0.16"},{"price":361000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":2,"type":"flat","distance":"0.18"},{"price":468000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":3,"type":"flat","distance":"0.18"},{"price":467950,"lat":"52.48789000","lng":"-1.89479000","bedrooms":3,"type":"flat","distance":"0.18"},{"price":466950,"lat":"52.48789000","lng":"-1.89479000","bedrooms":3,"type":"flat","distance":"0.18"},{"price":465500,"lat":"52.48789000","lng":"-1.89479000","bedrooms":3,"type":"flat","distance":"0.18"},{"price":381000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":2,"type":"flat","distance":"0.18"},{"price":379500,"lat":"52.48789000","lng":"-1.89479000","bedrooms":2,"type":"flat","distance":"0.18"},{"price":375000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":2,"type":"flat","distance":"0.18"},{"price":269500,"lat":"52.48789000","lng":"-1.89479000","bedrooms":1,"type":"flat","distance":"0.18"},{"price":229950,"lat":"52.48789000","lng":"-1.89479000","bedrooms":1,"type":"flat","distance":"0.18"},{"price":267000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":1,"type":"flat","distance":"0.18"},{"price":255555,"lat":"52.48789000","lng":"-1.89479000","bedrooms":1,"type":"flat","distance":"0.18"},{"price":249950,"lat":"52.48789000","lng":"-1.89479000","bedrooms":1,"type":"flat","distance":"0.18"},{"price":242000,"lat":"52.48789000","lng":"-1.89479300","bedrooms":1,"type":"flat","distance":"0.18"},{"price":241000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":1,"type":"flat","distance":"0.18"},{"price":234950,"lat":"52.48789000","lng":"-1.89479300","bedrooms":1,"type":"flat","distance":"0.18"},{"price":232000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":1,"type":"flat","distance":"0.18"},{"price":230000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":1,"type":"flat","distance":"0.18"},{"price":469000,"lat":"52.48789000","lng":"-1.89479000","bedrooms":3,"type":"flat","distance":"0.18"}]}';
  }

  private testPostcodeStoredRentsData(): string {
    return '{"long_let":{"points_analysed":20,"radius":"0.25","unit":"gbp_per_week","average":216,"70pc_range":[162,398],"80pc_range":[160,404],"90pc_range":[150,415],"100pc_range":[150,415],"raw_data":[{"price":150,"lat":"52.48656000","lng":"-1.89147600","bedrooms":6,"type":"detached_house","distance":"0.02"},{"price":150,"lat":"52.48755400","lng":"-1.89003700","bedrooms":12,"type":"flat","distance":"0.07"},{"price":162,"lat":"52.48762000","lng":"-1.89157000","bedrooms":1,"type":"detached_house","distance":"0.07"},{"price":254,"lat":"52.48762000","lng":"-1.89157000","bedrooms":null,"type":"flat","distance":"0.07"},{"price":162,"lat":"52.48555000","lng":"-1.89098000","bedrooms":1,"type":"detached_house","distance":"0.08"},{"price":231,"lat":"52.48555000","lng":"-1.89098000","bedrooms":null,"type":"flat","distance":"0.08"},{"price":185,"lat":"52.48555000","lng":"-1.89098000","bedrooms":null,"type":"flat","distance":"0.08"},{"price":160,"lat":"52.48664000","lng":"-1.89347000","bedrooms":1,"type":"detached_house","distance":"0.11"},{"price":210,"lat":"52.48648300","lng":"-1.89381900","bedrooms":null,"type":"flat","distance":"0.12"},{"price":200,"lat":"52.48648300","lng":"-1.89381900","bedrooms":null,"type":"flat","distance":"0.12"},{"price":190,"lat":"52.48648300","lng":"-1.89381900","bedrooms":1,"type":"flat","distance":"0.12"},{"price":175,"lat":"52.48648300","lng":"-1.89381900","bedrooms":1,"type":"flat","distance":"0.12"},{"price":162,"lat":"52.48760000","lng":"-1.89431000","bedrooms":1,"type":"flat","distance":"0.16"},{"price":398,"lat":"52.48770100","lng":"-1.89538000","bedrooms":3,"type":"flat","distance":"0.20"},{"price":415,"lat":"52.48770100","lng":"-1.89540000","bedrooms":2,"type":"flat","distance":"0.20"},{"price":392,"lat":"52.48744000","lng":"-1.89569000","bedrooms":2,"type":"flat","distance":"0.21"},{"price":404,"lat":"52.48744100","lng":"-1.89567700","bedrooms":2,"type":"flat","distance":"0.21"},{"price":277,"lat":"52.48799800","lng":"-1.89561300","bedrooms":2,"type":"flat","distance":"0.22"},{"price":415,"lat":"52.48742600","lng":"-1.89598100","bedrooms":2,"type":"flat","distance":"0.22"},{"price":277,"lat":"52.48863000","lng":"-1.89588600","bedrooms":2,"type":"flat","distance":"0.25"}]}}';
  }

  private testPostcodeStoredRestaurantData(): string {
    return `[ { "name": "Tesco", "address": "Aston University, Unit A Block D, The Aston Triangle", "type": "Retailers - other", "hygiene": null, "rating_date": "2019-01-11T00:00:00.000000Z", "lat": "52.48665130", "lng": "-1.89094710", "distance": "0.00" }, { "name": "B4 Bar", "address": "Subway, Aston Students Guild, 60 Aston Street, Birmingham", "type": "Restaurant/Cafe/Canteen", "hygiene": 5, "rating_date": "2018-11-16T00:00:00.000000Z", "lat": "52.48664600", "lng": "-1.89096600", "distance": "0.00" }, { "name": "Cafe Tierra", "address": "Aston University, Aston Street, Birmingham", "type": "Restaurant/Cafe/Canteen", "hygiene": 5, "rating_date": "2017-03-24T00:00:00.000000Z", "lat": "52.48664600", "lng": "-1.89096600", "distance": "0.00" }, { "name": "Costa Coffee", "address": "Aston University, Aston Street, Birmingham", "type": "Restaurant/Cafe/Canteen", "hygiene": 5, "rating_date": "2017-03-01T00:00:00.000000Z", "lat": "52.48664600", "lng": "-1.89096600", "distance": "0.00" }, { "name": "John Smith Guild Shop", "address": "Ground Floor, Aston Students Guild, 60 Aston Street, Birmingham", "type": "Retailers - other", "hygiene": 4, "rating_date": "2020-03-01T00:00:00.000000Z", "lat": "52.48664600", "lng": "-1.89096600", "distance": "0.00" }, { "name": "Rio's Piri Piri", "address": "Unit-4 the Old Fire Station, Aston Street, Birmingham", "type": "Restaurant/Cafe/Canteen", "hygiene": 5, "rating_date": "2020-09-30T23:00:00.000000Z", "lat": "52.48578262", "lng": "-1.89077699", "distance": "0.06" }, { "name": "Stars", "address": "83 Aston Street, Birmingham", "type": "Retailers - other", "hygiene": 5, "rating_date": "2020-03-01T00:00:00.000000Z", "lat": "52.48578200", "lng": "-1.89077600", "distance": "0.06" }, { "name": "Cafe Pause", "address": "Birmingham City Council, 1 Lancaster Circus Queensway, Birmingham", "type": "Restaurant/Cafe/Canteen", "hygiene": 5, "rating_date": "2018-03-22T00:00:00.000000Z", "lat": "52.48704200", "lng": "-1.89220200", "distance": "0.06" }, { "name": "Greggs Unit 2", "address": "67 Aston Street, Birmingham", "type": "Takeaway/sandwich shop", "hygiene": 5, "rating_date": "2018-10-30T00:00:00.000000Z", "lat": "52.48564810", "lng": "-1.89097790", "distance": "0.07" }, { "name": "Wok & Go", "address": "66 Aston Street, Birmingham", "type": "Takeaway/sandwich shop", "hygiene": 3, "rating_date": "2020-11-10T00:00:00.000000Z", "lat": "52.48559720", "lng": "-1.89106980", "distance": "0.07" }, { "name": "Pizza Hut Delivery", "address": "71 Lancaster Street, Birmingham", "type": "Takeaway/sandwich shop", "hygiene": 5, "rating_date": "2017-11-16T00:00:00.000000Z", "lat": "52.48729324", "lng": "-1.89292300", "distance": "0.09" }, { "name": "Brgri", "address": "Ben Jonson, 275 Corporation Street, Nechells", "type": "Restaurant/Cafe/Canteen", "hygiene": null, "rating_date": "2019-01-11T00:00:00.000000Z", "lat": "52.48785782", "lng": "-1.89147401", "distance": "0.09" }, { "name": "The Sack Of Potatoes", "address": "Sack Of Potatoes, 10 Gosta Green, Birmingham", "type": "Pub/bar/nightclub", "hygiene": 5, "rating_date": "2018-02-06T00:00:00.000000Z", "lat": "52.48741600", "lng": "-1.88829800", "distance": "0.12" }, { "name": "Aston Way Service Station", "address": "305 Corporation Street, Nechells, Birmingham", "type": "Retailers - other", "hygiene": 5, "rating_date": "2018-03-01T00:00:00.000000Z", "lat": "52.48882100", "lng": "-1.89104900", "distance": "0.15" }, { "name": "Chicken Hut", "address": "201 Corporation Street, Ladywood, Birmingham", "type": "Takeaway/sandwich shop", "hygiene": 4, "rating_date": "2018-08-19T23:00:00.000000Z", "lat": "52.48434600", "lng": "-1.89281200", "distance": "0.18" }, { "name": "Aunt Sally", "address": "193 Corporation Street, Ladywood, Birmingham", "type": "Takeaway/sandwich shop", "hygiene": 4, "rating_date": "2020-01-29T00:00:00.000000Z", "lat": "52.48434600", "lng": "-1.89281200", "distance": "0.18" }, { "name": "Bubble Waffles", "address": "195-199 Corporation Street, Ladywood, Birmingham", "type": "Restaurant/Cafe/Canteen", "hygiene": 2, "rating_date": "2020-03-05T00:00:00.000000Z", "lat": "52.48434600", "lng": "-1.89281200", "distance": "0.18" }, { "name": "Aisa Try It Love It", "address": "5 Ryder Street, Birmingham", "type": "Restaurant/Cafe/Canteen", "hygiene": null, "rating_date": "2019-02-14T00:00:00.000000Z", "lat": "52.48391950", "lng": "-1.89222020", "distance": "0.20" }, { "name": "The Campus Shop", "address": "Curzon Building, 4 Cardigan Street, Birmingham", "type": "Retailers - other", "hygiene": 4, "rating_date": "2020-03-01T00:00:00.000000Z", "lat": "52.48981900", "lng": "-1.89165000", "distance": "0.22" }, { "name": "Benugo Ltd", "address": "Curzon Building, 4 Cardigan Street, Birmingham", "type": "Hospitals/Childcare/Caring Premises", "hygiene": 5, "rating_date": "2018-04-29T23:00:00.000000Z", "lat": "52.48981900", "lng": "-1.89165000", "distance": "0.22" } ]`;
  }
}
